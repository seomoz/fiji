<!-- Assembly configuration for the release bundle. -->
<assembly
    xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2
                        http://maven.apache.org/xsd/assembly-1.1.2.xsd">
  <!--
    (c) Copyright 2012 WibiData, Inc.

    See the NOTICE file distributed with this work for additional
    information regarding copyright ownership.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
  -->
  <id>release</id>
  <formats>
    <format>dir</format>
    <!-- No longer tar up here - do so after running the redundant-jar python script. -->
    <!--<format>tar.gz</format>-->
  </formats>

  <includeBaseDirectory>true</includeBaseDirectory>
  <baseDirectory>fiji-bento-${codename}</baseDirectory>

  <fileSets>
    <fileSet>
      <!-- Put version info in the top-level directory. -->
      <outputDirectory></outputDirectory>
      <fileMode>0644</fileMode>
      <includes>
        <include>bento-version.txt</include>
      </includes>
      <filtered>true</filtered>
    </fileSet>
    <fileSet>
      <useDefaultExcludes>true</useDefaultExcludes>
      <outputDirectory></outputDirectory>
      <directory>../</directory>
      <fileMode>0644</fileMode>
      <includes>
        <include>NOTICE.txt</include>
        <include>LICENSE.txt</include>
        <include>README.md</include>
        <!-- log4j override to suppress hbase warnings -->
        <include>conf/log4j.properties</include>
        <include>conf/project-name.properties</include>
        <include>release-notes/**</include>
      </includes>
      <filtered>true</filtered>
    </fileSet>
    <!-- fiji-env.sh script for configuring environment. -->
    <fileSet>
      <useDefaultExcludes>true</useDefaultExcludes>
      <outputDirectory>bin</outputDirectory>
      <directory>src/main/scripts</directory>
      <fileMode>0755</fileMode>
      <includes>
        <include>fiji-env.sh</include>
      </includes>
    </fileSet>
    <fileSet>
      <!-- fiji-schema -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>.</outputDirectory>
      <directory>target/prereqs-dir/fiji-schema-${fiji-schema.version}</directory>
      <excludes>
        <exclude>bin/**</exclude>
        <exclude>RELEASE_NOTES.txt</exclude>
        <exclude>docs/**</exclude>
      </excludes>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-schema binaries -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>bin</outputDirectory>
      <directory>target/prereqs-dir/fiji-schema-${fiji-schema.version}/bin</directory>
      <excludes>
        <!-- Don't put profiling enable/disable scripts in bin/. -->
        <exclude>*-profiling.sh</exclude>
      </excludes>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-schema profiling binaries go in $KIJI_HOME/bin/profiling/ -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>bin/profiling</outputDirectory>
      <directory>target/prereqs-dir/fiji-schema-${fiji-schema.version}/bin</directory>
      <includes>
        <include>*-profiling.sh</include>
      </includes>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-schema api docs -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>docs/fiji-schema</outputDirectory>
      <directory>target/prereqs-dir/fiji-schema-${fiji-schema.version}/docs</directory>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-schema-shell -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>schema-shell</outputDirectory>
      <directory>target/prereqs-dir/fiji-schema-shell-${fiji-schema-shell.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <exclude>bin/**</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-schema-shell binaries -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>schema-shell/bin</outputDirectory>
      <directory>target/prereqs-dir/fiji-schema-shell-${fiji-schema-shell.version}/bin</directory>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-express -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>express</outputDirectory>
      <directory>target/prereqs-dir/fiji-express-${fiji-express.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <!-- This is already included by schema-shell. -->
        <exclude>lib/scala-library*.jar</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-express-tools -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>express</outputDirectory>
      <directory>target/prereqs-dir/fiji-express-tools-${fiji-express.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <!-- This is already included by schema-shell. -->
        <exclude>lib/scala-library*.jar</exclude>
        <exclude>bin/**</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-express-tools binaries -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>express/bin</outputDirectory>
      <directory>target/prereqs-dir/fiji-express-tools-${fiji-express.version}/bin</directory>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-phonebook examples -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>examples/phonebook</outputDirectory>
      <directory>target/prereqs-dir/fiji-phonebook-${fiji-phonebook.version}</directory>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-modeling -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>modeling</outputDirectory>
      <directory>target/prereqs-dir/fiji-modeling-${fiji-modeling.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <!-- This is already included by schema-shell/express. -->
        <exclude>lib/scala-library*.jar</exclude>
        <exclude>bin/**</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-music examples -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>examples/music</outputDirectory>
      <directory>target/prereqs-dir/fiji-music-${fiji-music.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <exclude>bin/**</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-music scripts -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>examples/music/bin</outputDirectory>
      <directory>target/prereqs-dir/fiji-music-${fiji-music.version}/bin</directory>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-express-music examples -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>examples/express-music</outputDirectory>
      <directory>target/prereqs-dir/fiji-express-music-${fiji-express-music.version}</directory>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-express-examples -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>examples/express-examples</outputDirectory>
      <directory>target/prereqs-dir/fiji-express-examples-${fiji-express-examples.version}</directory>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-mapreduce -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>.</outputDirectory>
      <directory>target/prereqs-dir/fiji-mapreduce-${fiji-mapreduce.version}</directory>
      <excludes>
        <exclude>RELEASE_NOTES.txt</exclude>
        <exclude>docs/**</exclude>
      </excludes>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- FijiMR profiling binaries -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>bin/profiling</outputDirectory>
      <directory>target/prereqs-dir/fiji-mapreduce-${fiji-mapreduce.version}/bin/profiling</directory>
      <filtered>false</filtered>
      <fileMode>755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-mapreduce api docs -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>docs/fiji-mapreduce</outputDirectory>
      <directory>target/prereqs-dir/fiji-mapreduce-${fiji-mapreduce.version}/docs</directory>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-mapreduce-lib -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>.</outputDirectory>
      <directory>target/prereqs-dir/fiji-mapreduce-lib-${fiji-mapreduce-lib.version}</directory>
      <excludes>
        <exclude>RELEASE_NOTES.txt</exclude>
        <exclude>docs/**</exclude>
      </excludes>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-mapreduce-lib api docs -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>docs/fiji-mapreduce-lib</outputDirectory>
      <directory>target/prereqs-dir/fiji-mapreduce-lib-${fiji-mapreduce-lib.version}/docs</directory>
      <filtered>false</filtered>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-hive-adapter-->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>hive-adapter</outputDirectory>
      <directory>target/prereqs-dir/fiji-hive-adapter-${fiji-hive-adapter.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <exclude>bin/**</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-hive-adapter binaries -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>hive-adapter/bin</outputDirectory>
      <directory>target/prereqs-dir/fiji-hive-adapter-${fiji-hive-adapter.version}/bin</directory>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-hive-tools -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>lib</outputDirectory>
      <directory>target/prereqs-dir/fiji-hive-tools-${fiji-hive-adapter.version}/lib</directory>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-rest -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>rest</outputDirectory>
      <directory>target/prereqs-dir/fiji-rest-cdh5-${fiji-rest.version}</directory>
      <filtered>false</filtered>
      <excludes>
        <exclude>bin/**</exclude>
      </excludes>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <!-- fiji-rest binaries -->
      <useDefaultExcludes>false</useDefaultExcludes>
      <outputDirectory>rest/bin</outputDirectory>
      <directory>target/prereqs-dir/fiji-rest-cdh5-${fiji-rest.version}/bin</directory>
      <filtered>false</filtered>
      <fileMode>0755</fileMode>
    </fileSet>
  </fileSets>
  <files>
    <!-- Mostly to move and rename release notes. -->
    <file>
      <!-- fiji-schema release notes -->
      <source>target/prereqs-dir/fiji-schema-${fiji-schema.version}/RELEASE_NOTES.txt</source>
      <outputDirectory>release-notes</outputDirectory>
      <destName>SCHEMA_RELEASE_NOTES.txt</destName>
      <fileMode>0644</fileMode>
    </file>
    <file>
      <!-- fiji-schema-shell release notes -->
      <source>target/prereqs-dir/fiji-schema-shell-${fiji-schema-shell.version}/RELEASE_NOTES.txt</source>
      <outputDirectory>release-notes</outputDirectory>
      <destName>DDL_RELEASE_NOTES.txt</destName>
      <fileMode>0644</fileMode>
    </file>
    <file>
      <!-- fijiMR release notes -->
      <source>target/prereqs-dir/fiji-mapreduce-${fiji-mapreduce.version}/RELEASE_NOTES.txt</source>
      <outputDirectory>release-notes</outputDirectory>
      <destName>MR_RELEASE_NOTES.txt</destName>
      <fileMode>0644</fileMode>
    </file>
    <file>
      <!-- fijiMR lib release notes -->
      <source>target/prereqs-dir/fiji-mapreduce-lib-${fiji-mapreduce-lib.version}/RELEASE_NOTES.txt</source>
      <outputDirectory>release-notes</outputDirectory>
      <destName>MRLIB_RELEASE_NOTES.txt</destName>
      <fileMode>0644</fileMode>
    </file>
    <file>
      <!-- fiji-express release notes -->
      <source>target/prereqs-dir/fiji-express-${fiji-express.version}/RELEASE_NOTES.txt</source>
      <outputDirectory>release-notes</outputDirectory>
      <destName>EXPRESS_RELEASE_NOTES.txt</destName>
      <fileMode>0644</fileMode>
    </file>
  </files>
  <dependencySets>
    <!-- BENTO-51: Include FijiSchema / FijiMR jars specially-compiled w/ profiling aspects. -->
    <dependencySet>
      <outputDirectory>lib/profiling</outputDirectory>
      <outputFileNameMapping>${artifact.artifactId}-${artifact.baseVersion}${dashClassifier?}.${artifact.extension}</outputFileNameMapping>
      <fileMode>0644</fileMode>
      <includes>
        <include>com.moz.fiji.schema:fiji-schema-profiling:jar:${fiji-schema.version}</include>
        <include>com.moz.fiji.mapreduce:fiji-mapreduce-profiling:jar:${fiji-mapreduce.version}</include>
        <include>org.aspectj:aspectjrt:jar:${aspectjrt.version}</include>
      </includes>
      <useProjectArtifact>false</useProjectArtifact>
      <useTransitiveDependencies>false</useTransitiveDependencies>
    </dependencySet>
  </dependencySets>
</assembly>
